{
  "title": "RAG Performance Dashboard",
  "tags": [
    "rag",
    "ai-louie",
    "retrieval"
  ],
  "timezone": "browser",
  "schemaVersion": 16,
  "version": 1,
  "refresh": "30s",
  "panels": [
    {
      "id": 999,
      "title": "",
      "type": "text",
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "options": {
        "mode": "html",
        "content": "\n<div style=\"text-align: center; margin-bottom: 8px;\">\n    <div style=\"display: inline-flex; align-items: center; gap: 6px; flex-wrap: wrap; justify-content: center;\">\n        <a href=\"/d/system-overview\" style=\"padding: 8px 16px; background: #1f1f1f; color: #33b5e5; border-radius: 4px; text-decoration: none; margin: 0 4px; display: inline-block; border: 1px solid #3274D9; transition: all 0.2s;\" onmouseover=\"this.style.background='#3274D9'; this.style.color='white';\" onmouseout=\"this.style.background='#1f1f1f'; this.style.color='#33b5e5';\">System Overview</a> <a href=\"/d/llm-metrics\" style=\"padding: 8px 16px; background: #1f1f1f; color: #33b5e5; border-radius: 4px; text-decoration: none; margin: 0 4px; display: inline-block; border: 1px solid #3274D9; transition: all 0.2s;\" onmouseover=\"this.style.background='#3274D9'; this.style.color='white';\" onmouseout=\"this.style.background='#1f1f1f'; this.style.color='#33b5e5';\">LLM Metrics</a> <span style=\"padding: 8px 16px; background: #3274D9; color: white; border-radius: 4px; font-weight: bold; margin: 0 4px;\">RAG Performance</span> <a href=\"/d/drift-monitoring\" style=\"padding: 8px 16px; background: #1f1f1f; color: #33b5e5; border-radius: 4px; text-decoration: none; margin: 0 4px; display: inline-block; border: 1px solid #3274D9; transition: all 0.2s;\" onmouseover=\"this.style.background='#3274D9'; this.style.color='white';\" onmouseout=\"this.style.background='#1f1f1f'; this.style.color='#33b5e5';\">Drift Monitoring</a> <a href=\"/d/alerts-overview\" style=\"padding: 8px 16px; background: #1f1f1f; color: #33b5e5; border-radius: 4px; text-decoration: none; margin: 0 4px; display: inline-block; border: 1px solid #3274D9; transition: all 0.2s;\" onmouseover=\"this.style.background='#3274D9'; this.style.color='white';\" onmouseout=\"this.style.background='#1f1f1f'; this.style.color='#33b5e5';\">Alerts Overview</a> <a href=\"/d/ai-governance-dashboard\" style=\"padding: 8px 16px; background: #1f1f1f; color: #33b5e5; border-radius: 4px; text-decoration: none; margin: 0 4px; display: inline-block; border: 1px solid #3274D9; transition: all 0.2s;\" onmouseover=\"this.style.background='#3274D9'; this.style.color='white';\" onmouseout=\"this.style.background='#1f1f1f'; this.style.color='#33b5e5';\">AI Governance</a>\n    </div>\n</div>\n"
      },
      "transparent": true
    },
    {
      "id": 1,
      "title": "RAG Request Rate",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 7
      },
      "targets": [
        {
          "expr": "rate(rag_request_total[5m])",
          "legendFormat": "RAG Request - {{endpoint}} - {{status}}"
        },
        {
          "expr": "rate(embedding_duration_seconds_count[5m])",
          "legendFormat": "Embedding - {{source}}"
        },
        {
          "expr": "rate(rerank_duration_seconds_count[5m])",
          "legendFormat": "Rerank - {{source}}"
        }
      ],
      "yaxes": [
        {
          "format": "short",
          "label": null,
          "logBase": 1,
          "show": true
        },
        {
          "format": "short",
          "label": null,
          "logBase": 1,
          "show": true
        }
      ]
    },
    {
      "id": 2,
      "title": "Embedding Latency (p95)",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 7
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, rate(embedding_duration_seconds_bucket[5m]))",
          "legendFormat": "{{model}} - {{batch_size_range}}"
        }
      ],
      "yaxes": [
        {
          "format": "s",
          "label": "Duration",
          "show": true
        }
      ]
    },
    {
      "id": 3,
      "title": "Rerank Latency (p95)",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 15
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, rate(rerank_duration_seconds_bucket[5m]))",
          "legendFormat": "{{model}} - {{candidate_count_range}}"
        }
      ],
      "yaxes": [
        {
          "format": "s",
          "label": "Duration",
          "show": true
        }
      ]
    },
    {
      "id": 4,
      "title": "RAG Request Latency (p50/p95/p99)",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 15
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.50, rate(rag_request_duration_seconds_bucket[5m]))",
          "legendFormat": "p50"
        },
        {
          "expr": "histogram_quantile(0.95, rate(rag_request_duration_seconds_bucket[5m]))",
          "legendFormat": "p95"
        },
        {
          "expr": "histogram_quantile(0.99, rate(rag_request_duration_seconds_bucket[5m]))",
          "legendFormat": "p99"
        }
      ],
      "yaxes": [
        {
          "format": "s",
          "label": "Duration",
          "show": true
        }
      ]
    },
    {
      "id": 5,
      "title": "Embedding Cache Hit Rate",
      "type": "gauge",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 23
      },
      "targets": [
        {
          "expr": "sum(rate(rag_operation_total{operation=\"embedding\",status=\"cache_hit\"}[5m])) / sum(rate(rag_operation_total{operation=\"embedding\"}[5m]))"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "min": 0,
          "max": 1,
          "thresholds": {
            "steps": [
              {
                "value": 0,
                "color": "red"
              },
              {
                "value": 0.5,
                "color": "yellow"
              },
              {
                "value": 0.8,
                "color": "green"
              }
            ]
          }
        }
      }
    },
    {
      "id": 6,
      "title": "End-to-End RAG Latency (p95)",
      "type": "stat",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 23
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, rate(rag_request_duration_seconds_bucket[5m]))"
        }
      ],
      "options": {
        "graphMode": "area",
        "colorMode": "value"
      },
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        }
      }
    },
    {
      "id": 7,
      "title": "Rerank Score Distribution",
      "type": "heatmap",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 23
      },
      "targets": [
        {
          "expr": "rate(rerank_score_distribution_bucket[5m])"
        }
      ]
    },
    {
      "id": 8,
      "title": "Inference Service Error Rate",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 31
      },
      "targets": [
        {
          "expr": "rate(rag_request_total{status=\"error\"}[5m])",
          "legendFormat": "RAG Request - {{endpoint}}"
        },
        {
          "expr": "rate(llm_request_total{endpoint=\"rag\",status=\"error\"}[5m])",
          "legendFormat": "LLM (RAG) - {{model}}"
        }
      ],
      "yaxes": [
        {
          "format": "short",
          "label": null,
          "logBase": 1,
          "show": true
        },
        {
          "format": "short",
          "label": null,
          "logBase": 1,
          "show": true
        }
      ]
    },
    {
      "id": 9,
      "title": "Circuit Breaker State",
      "type": "stat",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 31
      },
      "targets": [
        {
          "expr": "rag_operation_total",
          "legendFormat": "{{service}}"
        }
      ],
      "options": {
        "colorMode": "background"
      },
      "fieldConfig": {
        "defaults": {
          "mappings": [
            {
              "type": "value",
              "options": {
                "0": {
                  "text": "Closed",
                  "color": "green"
                }
              }
            },
            {
              "type": "value",
              "options": {
                "1": {
                  "text": "Open",
                  "color": "red"
                }
              }
            },
            {
              "type": "value",
              "options": {
                "2": {
                  "text": "Half-Open",
                  "color": "yellow"
                }
              }
            }
          ]
        }
      }
    }
  ],
  "uid": "rag-performance"
}